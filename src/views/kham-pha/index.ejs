<!DOCTYPE html>
<html lang="vi-VN" data-gen-themes="light">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no"/>
    <meta name="description" content="Gender Insights là dự án giáo dục giới tính cho thanh thiếu niên, đồng thời nâng cao nhận thức cộng đồng về phòng chống xâm hại tình dục trẻ em."/>
    <meta name="author" content="Gender Insights"/>
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1"/>
    <meta property="og:site_name" content="Gender Insights"/>
    <meta property="og:type" content="website"/>
    <meta property="og:url" content="https://genderinsights.vercel.app/"/>
    <meta property="og:locale" content="vi_VN"/>
    <meta property="og:title" content="Gender Insights | Giáo Dục Giới Tính & Phòng Chống Xâm Hại"/>
    <meta property="og:description" content="Gender Insights là dự án giáo dục giới tính cho thanh thiếu niên, đồng thời nâng cao nhận thức cộng đồng về phòng chống xâm hại tình dục trẻ em."/>
    <meta property="og:image" content="https://genderinsights.vercel.app/photos/brands/gender-insights.svg"/>
    <meta property="og:image:alt" content="Gender Insights"/>
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:title" content="Gender Insights | Giáo Dục Giới Tính & Phòng Chống Xâm Hại"/>
    <meta name="twitter:description" content="Gender Insights là dự án giáo dục giới tính cho thanh thiếu niên, đồng thời nâng cao nhận thức cộng đồng về phòng chống xâm hại tình dục trẻ em."/>
    <meta name="twitter:image" content="https://genderinsights.vercel.app/photos/brands/gender-insights.svg"/>
    <meta name="google-site-verification" content="WYtNJAPGpG3GU15m7LDN27dg87rSi9SSYkL4o1Oc3LQ"/>
    <title>Gender Insights | Giáo Dục Giới Tính & Phòng Chống Xâm Hại</title>
    <link rel="preconnect" href="https://genderinsights.vercel.app/" crossorigin/>
    <link rel="shortcut icon" href="https://genderinsights.vercel.app/photos/brands/gender-insights.ico" type="image/x-icon"/>
    <link rel="canonical" href="https://genderinsights.vercel.app/"/>
    <link rel="alternate" href="https://genderinsights.vercel.app/" hreflang="vi-VN"/>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin/>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net"/>
    <link rel="preload" href="/fonts/Montserrat/Montserrat.woff2" as="font" type="font/woff2" crossorigin="anonymous"/>
    <link rel="stylesheet" href="/fonts/index.css"/>
    <link rel="stylesheet" href="/css/components/bases.css"/>
    <link rel="stylesheet" href="/css/components/main.css"/>
    <link rel="stylesheet" href="/css/trang-chu.css"/>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css"/></noscript>
    <link rel="prefetch" href="https://genderinsights.vercel.app/series/"/>
    <link rel="prefetch" href="https://genderinsights.vercel.app/kham-pha/"/>
    <link rel="prefetch" href="https://genderinsights.vercel.app/tin-tuc/"/>
    <link rel="prefetch" href="https://genderinsights.vercel.app/su-kien/"/>
    <link rel="prefetch" href="https://genderinsights.vercel.app/dien-dan/"/>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        html, body, input, select, button {
            font-family: 'Montserrat', 'Segoe UI', Roboto, Arial, sans-serif;
        }
    </style>
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "@id": "https://genderinsights.vercel.app/",
            "name": "Gender Insights",
            "alternateName": "GI",
            "url": "https://genderinsights.vercel.app/",
            "logo": {
                "@type": "ImageObject",
                "url": "https://genderinsights.vercel.app/photos/brands/gender-insights.svg"
            },
            "description": "Gender Insights là dự án giáo dục giới tính cho thanh thiếu niên, đồng thời nâng cao nhận thức cộng đồng về phòng chống xâm hại tình dục trẻ em.",
            "address": {
                "@type": "PostalAddress",
                "addressLocality": "Thanh Xuân",
                "addressRegion": "Hà Nội",
                "addressCountry": "VN"
            },
            "contactPoint": [
                {
                "@type": "ContactPoint",
                "telephone": "+84-822-443-338",
                "contactType": "customer service",
                "areaServed": "VN",
                "availableLanguage": "Vietnamese"
                },
                {
                "@type": "ContactPoint",
                "telephone": "+84-377-560-931",
                "contactType": "customer service",
                "areaServed": "VN",
                "availableLanguage": "Vietnamese"
                },
                {
                "@type": "ContactPoint",
                "telephone": "+84-382-556-109",
                "contactType": "customer service",
                "areaServed": "VN",
                "availableLanguage": "Vietnamese"
                }
            ],
            "sameAs": [
                "http://www.facebook.com/GenderInsights",
                "https://www.tiktok.com/@genderinsights.no1",
                "https://open.spotify.com/show/4t3HLpqTjllUVLZ0QUFnFv?nd=1"
            ]
        }
    </script>
    <script>
        const preferredTheme = ['light', 'dark'].includes(localStorage.theme) ? localStorage.theme : (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        document.documentElement.setAttribute('data-gen-themes', preferredTheme);
    </script>
</head>
<body>
    <%- include('../partials/header') %>
        <main>
            <div class="container">

                <% let heroMain=null; let heroSide=[]; let mainList=[]; if (typeof posts !=='undefined' && posts.length>
                    0) {
                    // Adjust: Use available posts
                    heroMain = posts[0];
                    heroSide = posts.slice(1, 4);
                    mainList = posts.slice(4);
                    }
                    %>

                    <section class="hero-section">
                        <% if (heroMain) { %>
                            <div class="hero-main">
                                <a href="/kham-pha/<%= heroMain.slug %>"
                                    style="display:block; width:100%; height:100%;">
                                    <img src="<%= heroMain.thumbnail || '/photos/placeholder-m6a0q.png' %>"
                                        alt="<%= heroMain.title %>" class="hero-bg">
                                    <div class="hero-gradient"></div>

                                    <div class="hero-top">
                                        <span class="badge-red">
                                            <%= heroMain.category || 'NỔI BẬT' %>
                                        </span>
                                        <span class="badge-date">
                                            <%= heroMain.displayDate || heroMain.date %>
                                        </span>
                                    </div>

                                    <div class="hero-content">
                                        <div class="hero-stats">
                                            <span class="author-item"><i class="fa-regular fa-user"></i>
                                                <%= heroMain.author || 'Admin' %>
                                            </span>
                                            <span class="divider">/</span>
                                            <span><i class="fa-regular fa-eye"></i>
                                                <%= heroMain.views || 0 %> views
                                            </span>
                                            <span class="divider">/</span>
                                            <span class="stars">
                                                <% const hRating=heroMain.avgRating || 0; %>
                                                    <% for(let i=1; i<=5; i++) { %>
                                                        <i class="fa-solid fa-star"
                                                            style="<%= i <= Math.round(hRating) ? 'color: var(--yellow-star);' : 'color: #ccc;' %>"></i>
                                                        <% } %>
                                            </span>
                                            <span>(<%= heroMain.totalRatings || 0 %>)</span>
                                        </div>

                                        <h2 class="hero-title">
                                            <%= heroMain.title %>
                                        </h2>
                                        <p class="hero-desc">
                                            <%= heroMain.description %>
                                        </p>
                                    </div>
                                </a>

                                <div class="share-wrapper"
                                    style="position: absolute; bottom: 30px; right: 30px; z-index: 5;">
                                    <button class="hero-share share-action card-share-button" title="Chia sẻ"><i
                                            class="fa-solid fa-share-nodes"></i></button>
                                    <!-- Radial Menu -->
                                    <div class="radial-share-menu">
                                        <div class="radial-backdrop"></div>
                                        <div class="radial-track">
                                            <a href="#" class="share-item share-action" data-platform="facebook"
                                                data-slug="<%= heroMain.slug %>" data-title="<%= heroMain.title %>"
                                                title="Facebook"><i class="fa-brands fa-facebook"></i></a>
                                            <a href="#" class="share-item share-action" data-platform="messenger"
                                                data-slug="<%= heroMain.slug %>" data-title="<%= heroMain.title %>"
                                                title="Messenger"><i class="fa-brands fa-facebook-messenger"></i></a>
                                            <a href="#" class="share-item share-action" data-platform="twitter"
                                                data-slug="<%= heroMain.slug %>" data-title="<%= heroMain.title %>"
                                                title="Twitter"><i class="fa-brands fa-x-twitter"></i></a>
                                            <a href="#" class="share-item share-action" data-platform="copy"
                                                data-slug="<%= heroMain.slug %>" data-title="<%= heroMain.title %>"
                                                title="Copy"><i class="fa-solid fa-copy"></i></a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <% } else { %>
                                <div class="hero-main"
                                    style="background:#333; display:flex; align-items:center; justify-content:center;">
                                    <p style="color:white;">Đang cập nhật...</p>
                                </div>
                                <% } %>

                                    <div class="hero-nav">
                                        <% if (heroSide.length> 0) { %>
                                            <% heroSide.forEach(sub=> { %>
                                                <div class="nav-item"
                                                    style="background-image: url('<%= sub.thumbnail || '/photos/placeholder-m6a0q.png' %>');">
                                                    <a href="/kham-pha/<%= sub.slug %>"
                                                        style="position:absolute; inset:0; z-index:1;"></a>
                                                    <div class="nav-overlay"></div>
                                                    <div class="nav-top">
                                                        <span class="mini-badge">
                                                            <%= sub.category || 'Mới' %>
                                                        </span>
                                                        <span class="mini-date">
                                                            <%= sub.displayDate || sub.date %>
                                                        </span>
                                                    </div>
                                                    <div class="nav-content">
                                                        <div class="nav-text-info">
                                                            <div class="nav-meta-line">
                                                                <span class="nav-author"><i
                                                                        class="fa-regular fa-user"></i>
                                                                    <%= sub.author || 'Admin' %>
                                                                </span>
                                                                <span class="nav-dot">/</span>
                                                                <span class="nav-view"><i class="fa-regular fa-eye"></i>
                                                                    <%= sub.views || 0 %>
                                                                </span>
                                                            </div>
                                                            <h4 class="nav-title">
                                                                <%= sub.title %>
                                                            </h4>
                                                        </div>
                                                    </div>
                                                </div>
                                                <% }) %>
                                                    <% } %>
                                    </div>
                    </section>

                    <div class="content-wrapper">

                        <div class="post-list" id="kham-pha-grid-container">
                            <%- include('../partials/card-kham-pha', { posts: mainList }) %>
                        </div>

                        <aside class="sidebar">
                            <div class="sidebar-widget">
                                <h3 class="widget-head">Bài Viết Phổ Biến</h3>
                                <% if (typeof popularPosts !=='undefined' && popularPosts.length> 0) { %>
                                    <% popularPosts.forEach(p=> { %>
                                        <div class="pop-item">
                                            <a href="/kham-pha/<%= p.slug %>" class="pop-img"
                                                style="background-image: url('<%= p.thumbnail || '/photos/placeholder-m6a0q.png' %>'); display:block;"></a>
                                            <div class="pop-text">
                                                <a href="/kham-pha/<%= p.slug %>"
                                                    style="text-decoration:none; color:inherit;">
                                                    <span>
                                                        <%= p.displayDate || p.date %>
                                                    </span>
                                                    <h4>
                                                        <%= p.title %>
                                                    </h4>
                                                </a>
                                            </div>
                                        </div>
                                        <% }) %>
                                            <% } else { %>
                                                <p>Chưa có dữ liệu.</p>
                                                <% } %>
                            </div>
                        </aside>
                    </div>

                    <div class="load-more-container" style="margin-top: 30px;">
                        <button id="btn-load-more-kham-pha" class="load-more-btn-styled" data-type="explore"
                            data-page="2">
                            Xem Thêm
                        </button>
                    </div>

            </div>
        </main>
        <%- include('../partials/footer') %>

            <script src="/js/radial-menu.js"></script>
            <script>
                document.addEventListener('DOMContentLoaded', () => {
                    const gridContainer = document.getElementById('kham-pha-grid-container');
                    const loadMoreBtn = document.getElementById('btn-load-more-kham-pha');
                    let currentPage = 2; // Since we rendered page 1

                    async function loadMore() {
                        loadMoreBtn.innerHTML = 'Đang tải...';
                        loadMoreBtn.disabled = true;

                        try {
                            const res = await fetch(`/api/posts?type=explore&page=${currentPage}&limit=6`);
                            const data = await res.json();

                            if (data.success && data.html) {
                                gridContainer.insertAdjacentHTML('beforeend', data.html);

                                if (data.hasMore) {
                                    currentPage++;
                                    loadMoreBtn.innerHTML = 'Xem Thêm';
                                    loadMoreBtn.disabled = false;
                                } else {
                                    loadMoreBtn.style.display = 'none';
                                }

                                if (window.initRadialMenus) window.initRadialMenus();
                            }
                        } catch (e) {
                            console.error(e);
                            loadMoreBtn.innerHTML = 'Thử lại';
                            loadMoreBtn.disabled = false;
                        }
                    }

                    if (loadMoreBtn) {
                        loadMoreBtn.addEventListener('click', loadMore);
                    }
                    if (window.initRadialMenus) window.initRadialMenus();
                });
            </script>
            <style>
                .load-more-btn-styled {
                    padding: 12px 30px;
                    background: var(--green-btn);
                    color: white;
                    border-radius: 8px;
                    border: none;
                    cursor: pointer;
                    font-weight: 600;
                    transition: 0.3s;
                }

                .load-more-btn-styled:hover {
                    background: #4db685;
                    box-shadow: 0 4px 12px rgba(95, 203, 151, 0.4);
                }
            </style>
</body>

</html>